apiVersion: operator.alaudadevops.io/v1alpha1
kind: Sonarqube
metadata:
  name: ingress-oidc
spec:
  helmValues:
    postgresql:
      enabled: false
      postgresqlUsername: "postgres"
      postgresqlPassword: "Wq6KbZtVti"
      postgresqlDatabase: "sonardb"
      postgresqlServer: "pg-postgresql.<namespace>.svc.cluster.local"
      postgresqlSSL: "false"
      service:
        port: 5432
    prometheusExporter:
      enabled: false
    ingress:
      enabled: true
      hosts:
        - name: test-https-sso.example.com
      tls:
        - secretName: test-tls-cert
          hosts:
            - test-https-sso.example.com
    persistence:
      existingClaim: pvc-sonarqube
    oidc:
      enable: true
      clientID: test-dex
      serverURL: https://test-https-sso.example.com
      clientSecret: Z2l0bGFiLW9mZmljaWFsLTAK
      issuer: https://192.168.140.52/dex
      scope: '["openid" ,"email" ,"groups" ,"profile" ,"offline_access"]'
      sonarqube:
        forceAuthentication: "false"
        loginStrategy: Email
        response_types_supported: '["code" ,"id_token" ,"token"]'
        subject_types_supported: '["public"]'
        token_endpoint_auth_methods_supported: '["client_secret_basic"]'
        id_token_signing_alg_values_supported: '["RS256"]'
        claims_supported: '["aud" ,"email" ,"email_verified" ,"exp" ,"iat" ,"iss" ,"locale" ,"name" ,"sub"]'
        tlsCrt: dex-tls
      verifyCert: true
